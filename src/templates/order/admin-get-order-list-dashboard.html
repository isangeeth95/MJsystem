{%  extends 'base.html' %}
<head xmlns="http://www.w3.org/1999/html">
    <title>Bootstrap Example</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
</head>

{% block dashboard-body %}

<div class="card mb-3">
    <div class="card-header">
        <i class="fas fa-table"></i>Get Order History in Admin Dashboard</div>
    <div class="container" style="margin-top: 20px">

            <form class="form" method="POST" action='{% url "order_list_view" %}'>{% csrf_token %}
      <button type="submit" style="background-color: green; border-radius: 7%; color: white">Get Order History in Site Page</button>
    </form>

        <input style="margin-top: 20px" type="text" name="search" id="search2" class="form-control form-control-sm" placeholder="Search">
        <div id="order" class="card border-0 shadow my-5">
            <h4>Order History</h4>
            {% if order_list %}
            <table id="order_table" class="table table-striped table-bordered" style="width:100%">
                <thead>
                <tr>
                    <th>#</th>
                    <th>Order ID</th>
                    <th>Billing profile:</th>
                    <th>Delivering address:</th>
                    <th>Billing address:</th>
                    <th>Cart</th>
                    <th>Delivering total</th>
                    <th>Total</th>
                    <th>States</th>

                </tr>
                </thead>
                <tbody>
                {% for order in order_list %}
                <tr style="color: black">
                    <th>{{ forloop.counter}}</th>
                    <th>{{ order.order_id}}</th>
                    <th>{{ order.billing_profile}}</th>
                    <th>{{ order.delivering_address}}</th>
                    <th>{{ order.billing_address.get_address }}</th>
                    <th>{{ order.cart}}</th>
                    <th>{{ order.delivering_total}}</th>
                    <th>{{ order.total}}</th>
                    <th>{{ order.status}}</th>
                </tr>
                {% endfor %}
                </tbody>

            </table>
            {% else %}
            <p>You haven't placed any orders yet.</p>
            {% endif %}

        </div>


    </div>
</div>
</div>

</div>
</div>
<script>
    $(document).ready(function () {
        $('#search2').keyup(function () {
            search_table($(this).val());
        });

        function search_table(value) {
            $('#order_table tr').each(function () {
                var found = false;
                $(this).each(function () {
                    if($(this).text().toLowerCase().indexOf(value.toLowerCase()) >= 0){
                        found = true;
                    }
                });
                if(found == true){
                    $(this).show();
                }
                else {
                    $(this).hide();
                }
            });
        }
    })
</script>

{%endblock%}

{% block title%}order lists {% endblock %}



